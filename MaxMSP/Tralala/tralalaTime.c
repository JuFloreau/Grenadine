/*
 *  tralalaTime.c
 *
 *  nicolas.danet@free.fr
 *
 */

// -------------------------------------------------------------------------------------------------------------
// -------------------------------------------------------------------------------------------------------------

#include "tralalaTime.h"

// -------------------------------------------------------------------------------------------------------------
// -------------------------------------------------------------------------------------------------------------

#define TLL_MAGIC 3402300126UL

// -------------------------------------------------------------------------------------------------------------
// -------------------------------------------------------------------------------------------------------------
#pragma mark -
#pragma mark ---
#pragma mark -

void tralala_timeInit(t_time *x)
{
    t_symbol *s = symbol_unique( );
    s->s_thing = (t_object *)x;
    atom_setsym(&x->link, s);
    x->magic = TLL_MAGIC;
    x->time = PIZ_TIME_ZERO;
}

t_atom *tralala_atomWithTime(t_time *x)
{
    return &x->link;
}

t_time *tralala_timeWithAtom(t_atom *a)
{
    t_time *time = NULL;
    t_symbol *s = NULL;
    
    if ((atom_gettype(a) == A_SYM) && (s = atom_getsym(a)) && (time = (t_time *)s->s_thing)) {
    //
    if ((*((long *)time)) != TLL_MAGIC) {
        time = NULL;
    } 
    //    
    }
    
    return time;
}
    
// -------------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------:x